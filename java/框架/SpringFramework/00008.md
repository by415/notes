### Springä¸­çš„Qualifieråº”ç”¨
---
####åº”ç”¨
  @Qualifierå¯ä»¥ç”¨æ¥è®©ç¨‹åºå‘˜æ˜ç¡®æŒ‡å®šæƒ³è¦æŒ‡å®šå“ªä¸ªbeanï¼Œé‚£æœ‰ç¨‹åºå‘˜å°±ä¼šæƒ³é—®ï¼Œå®ƒå’Œ@Autowiredå’Œ@Resourceçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
  
  å‡è®¾æœ‰å¦‚ä¸‹beanå®šä¹‰ï¼š
  
  ```xml
<bean id="user0" class="com.luban.entity.User">
        <property name="name" value="user0000"/>
    </bean>

    <bean id="user1" class="com.luban.entity.User" >
        <property name="name" value="user1111"/>
    </bean>

    <bean name="userService" class="com.luban.service.UserService" autowire="constructor"/>
```
  user0å’Œuser1çš„ç±»å‹éƒ½æ˜¯userï¼Œ
  UserServiceçš„é€šè¿‡æ„é€ æ–¹æ³•è‡ªåŠ¨æ³¨å…¥

```java
public class UserService {

    private User user;

    public UserService(User user11) {
        this.user = user11;
    }

    public void test() {
        System.out.println(user.getName());
    }
}

```
  mainæ–¹æ³•ï¼š

```java
    public static void main(String[] args) {
        ClassPathXmlApplicationContext applicationContext = new ClassPathXmlApplicationContext("spring.xml");

        UserService userService = applicationContext.getBean("userService", UserService.class);
        userService.test();
    }
```

  ç°åœ¨è¿è¡Œmainæ–¹æ³•ï¼Œä¼šå¯åŠ¨Springï¼Œä¼šæŠ¥é”™ï¼š
```java
Caused by: org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type 'com.luban.entity.User' available: expected single matching bean but found 2: user0,user1
    at org.springframework.beans.factory.config.DependencyDescriptor.resolveNotUnique(DependencyDescriptor.java:223)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1324)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1255)
    at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:939)
    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:842)
    ... 15 more
```

  
  å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºUserServiceä¼šæ ¹æ®æ„é€ æ–¹æ³•è‡ªåŠ¨æ³¨å…¥ï¼Œä¼šå…ˆæ ¹æ®æ„é€ æ–¹æ³•å‚æ•°ç±»å‹Useræ˜¯æ‰¾beanï¼Œæ‰¾åˆ°äº†ä¸¤ä¸ªï¼Œä¸€ä¸ªuser0, ä¸€ä¸ªuser1ï¼Œç„¶åä¼šæ ¹æ®æ„é€ æ–¹æ³•å‚æ•°åuser11å»è¿›è¡Œè¿‡æ»¤ï¼Œä½†æ˜¯è¿‡æ»¤ä¸å‡ºæ¥ï¼Œæœ€ç»ˆè¿˜æ˜¯æ‰¾åˆ°äº†ä¸¤ä¸ªï¼Œæ‰€ä»¥æ²¡æ³•è¿›è¡Œè‡ªåŠ¨æ³¨å…¥ï¼Œæ‰€ä»¥æŠ¥é”™ã€‚

  æ€ä¹ˆåŠï¼Ÿ
  
  è¦ä¹ˆç»™å…¶ä¸­æŸä¸ªbeanè®¾ç½®primaryä¸ºtrueï¼Œè¡¨ç¤ºæ‰¾åˆ°å¤šä¸ªæ—¶é»˜è®¤ç”¨è¿™ä¸ªã€‚
  
  æˆ–è€…ç»™æŸä¸ªbeanè®¾ç½®autowire-candidateä¸ºfalseï¼Œè¡¨ç¤ºè¿™ä¸ªbeanä¸ä½œä¸ºè‡ªåŠ¨æ³¨å…¥çš„å€™é€‰è€…ã€‚
  
  è¿˜æœ‰ä¸€ç§å°±æ˜¯@Qualifier, é¦–å…ˆï¼Œç»™ä¸¤ä¸ªbeanåˆ†åˆ«å®šä¹‰ä¸€ä¸ªqualifierï¼š
  
  ```java
      <bean id="user0" class="com.luban.entity.User" autowire-candidate="false">
          <property name="name" value="user0000"/>
          <qualifier value="user00"/>
      </bean>
  
      <bean id="user1" class="com.luban.entity.User" >
          <property name="name" value="user1111"/>
          <qualifier value="user11"/>
      </bean>
```
  åŒæ—¶åœ¨UserServiceä¸­ä½¿ç”¨@Qualifieræ³¨è§£ï¼š
  ```java
    public UserService(@Qualifier("user00") User user11) {
            this.user = user11;
        }  
  ```
  è¿˜éœ€è¦åšä¸€ä»¶äº‹æƒ…ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä½¿ç”¨çš„XMLçš„æ–¹å¼ä½¿ç”¨Springï¼Œæ‰€ä»¥è¿˜éœ€è¦æ·»åŠ ï¼š
```xml
    <context:annotation-config/>

```
  
  è¿™æ ·@Qualifieræ³¨è§£æ‰ä¼šç”Ÿæ•ˆï¼Œè¿™æ ·é…ç½®ä¹‹åUserServiceä¸­çš„userå±æ€§å°±ä¼šè¢«èµ‹å€¼ä¸º@Qualifier("user00")æ‰€å¯¹åº”çš„user0è¿™ä¸ªbeanã€‚
  
  @Qualifieræ³¨è§£æ˜¯åœ¨ä½¿ç”¨ç«¯å»æŒ‡å®šæƒ³è¦ä½¿ç”¨çš„beanï¼Œè€Œautowire-candidateå’Œprimaryæ˜¯åœ¨é…ç½®ç«¯ã€‚
  
  @Qualifierçš„å¦å¤–ä¸€ç§ç”¨æ³•
  
  å®šä¹‰ä¸€ä¸ªï¼š
  ```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier
public @interface Genre {

    String value();
}  
```
  ä¿®æ”¹beançš„å®šä¹‰
  
```xml
<bean id="user0" class="com.luban.entity.User">
<property name="name" value="user0000"/>
<qualifier type="com.luban.annotation.Genre" value="user00"/>
</bean>

<bean id="user1" class="com.luban.entity.User" >
<property name="name" value="user1111"/>
<qualifier type="com.luban.annotation.Genre" value="user11"/>
</bean>
```
  UserServiceä¸­ä½¿ç”¨Genreæ³¨è§£ï¼š

```java
public class UserService {

    private User user;

    public UserService(@Genre("user00") User user11) {
        this.user = user11;
    }

    public void test() {
        System.out.println(user.getName());
    }
}
```
  è¿™ç§ç”¨æ³•ç›¸å½“äºè‡ªå®šä¹‰@Qualifieræ³¨è§£ï¼Œä½¿å¾—å¯ä»¥å¤„ç†æ›´å¤šçš„æƒ…å†µã€‚

  åŒæ ·ï¼Œè¿˜å¯ä»¥è¿™ä¹ˆåšï¼Œå®šä¹‰ä¸¤ä¸ªæ³¨è§£ï¼š
  
  ```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier("random")
public @interface Random {

}  
```

```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier("roundRobin")
public @interface RoundRobin {
    
}
```
  æ³¨æ„ï¼Œæ˜¯åœ¨è‡ªå®šä¹‰çš„Qualifieræ³¨è§£ä¸ŠæŒ‡å®šäº†åå­—ï¼Œè¿™æ ·å°±æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ï¼Œè€Œä¸ç”¨æŒ‡å®šåå­—äº†ã€‚æ¯”å¦‚å…ˆä¿®æ”¹beançš„å®šä¹‰ï¼š
  
  ```xml
<bean id="user0" class="com.luban.entity.User">
        <property name="name" value="user0000"/>
        <qualifier type="com.luban.annotation.Random"/>
    </bean>

    <bean id="user1" class="com.luban.entity.User" >
        <property name="name" value="user1111"/>
        <qualifier type="com.luban.annotation.RoundRobin"/>
    </bean>  
```

  UserServiceä¸­å°±å¯ä»¥è¿™ä¹ˆç”¨:
  
  ```java
      public UserService(@RoundRobin User user11) {
          this.user = user11;
      }
```

---
*[ğŸ‘ˆ 0000 Javaç›®å½•](../../0000Javaç›®å½•.md)*

*[415 å‡ºå“ï¼Œå¿…å±ç²¾å“](../../../note.md)*